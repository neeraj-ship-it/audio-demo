/**
 * HARYANVI STORY GENERATOR
 * Generates audio story in Haryanvi language/accent
 * Duration: 10-15 minutes
 */

require('dotenv').config({ path: require('path').join(__dirname, '..', '.env.local') });
const fs = require('fs');
const path = require('path');
const https = require('https');
const AWS = require('aws-sdk');
const { execSync } = require('child_process');

// Configure AWS S3
const s3 = new AWS.S3({
  accessKeyId: process.env.AWS_ACCESS_KEY_ID,
  secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY,
  region: process.env.AWS_REGION
});

// Haryanvi Story Script - Kaand 2010 Style
const HARYANVI_SCRIPT = `
à¤¸à¥à¤£à¥‹ à¤­à¤¾à¤ˆ à¤¸à¤¾à¤¬, à¤¯à¥‡ à¤•à¤¹à¤¾à¤¨à¥€ à¤¸à¥ˆ à¤¹à¤°à¤¿à¤¯à¤¾à¤£à¤¾ à¤•à¥‡ à¤à¤• à¤›à¥‹à¤Ÿà¥‡ à¤¸à¥‡ à¤—à¤¾à¤® à¤•à¥€à¥¤ à¤—à¤¾à¤® à¤•à¤¾ à¤¨à¤¾à¤® à¤¸à¥ˆ "à¤§à¤¨à¥Œà¤°à¤¾"à¥¤ à¤¸à¤¾à¤² à¤¸à¥ˆ 2010 à¤•à¤¾à¥¤ à¤‰à¤¨ à¤¦à¤¿à¤¨à¤¾à¤‚ à¤—à¤¾à¤® à¤®à¥à¤¹ à¤šà¥‹à¤°à¥€-à¤¡à¤•à¥ˆà¤¤à¥€ à¤•à¤¾ à¤•à¤¾à¤£à¥à¤¡à¤¼ à¤¬à¤¡à¤¼à¤¾ à¤¤à¥‡à¤œà¤¼ à¤¹à¥‹ à¤°à¥à¤¯à¤¾ à¤¸à¥ˆà¥¤

à¤—à¤¾à¤® à¤®à¥à¤¹ à¤°à¤¹à¤µà¥‡ à¤¸à¥ˆ à¤°à¤¾à¤œà¥‚à¥¤ à¤œà¤µà¤¾à¤¨ à¤›à¥‹à¤°à¤¾à¥¤ à¤®à¤œà¤¼à¤¬à¥‚à¤¤à¥¤ à¤ªà¤° à¤—à¤°à¥€à¤¬ à¤ªà¤°à¤¿à¤µà¤¾à¤° à¤•à¤¾à¥¤ à¤¬à¤¾à¤ª à¤•à¥€ à¤¬à¥€à¤®à¤¾à¤°à¥€ à¤¨à¥à¤¯à¥‚ à¤‡à¤²à¤¾à¤œ à¤•à¤°à¤µà¤¾à¤£ à¤–à¤¾à¤¤à¤° à¤‰à¤¸à¤¨à¥à¤¨à¥ˆ à¤¬à¤¡à¤¼à¥€ à¤®à¥‡à¤¹à¤¨à¤¤ à¤•à¤°à¥€ à¤¸à¥ˆà¥¤ à¤ªà¤° à¤ªà¥ˆà¤¸à¥‡ à¤•à¤® à¤ªà¤¡à¤¼ à¤°à¥à¤¹à¥‡à¥¤

à¤à¤• à¤¦à¤¿à¤¨ à¤°à¤¾à¤œà¥‚ à¤¨à¥à¤¯à¥‚ à¤®à¤¿à¤²à¥à¤¯à¤¾ à¤à¤• à¤†à¤¦à¤®à¥€à¥¤ à¤¨à¤¾à¤® à¤¸à¥ˆ à¤¶à¤‚à¤•à¤°à¥¤ à¤¶à¤¹à¤° à¤¤à¥ˆ à¤†à¤¯à¤¾ à¤¸à¥ˆà¥¤ à¤¬à¥‹à¤²à¥à¤¯à¤¾ - "à¤°à¤¾à¤œà¥‚, à¤¥à¤¾à¤°à¥‡ à¤ªà¥à¤°à¥‰à¤¬à¥à¤²à¤® à¤•à¤¾ solution à¤¸à¥ˆ à¤®à¥‡à¤°à¥‡ à¤•à¥‹à¤²à¥ˆà¥¤ à¤à¤• à¤•à¤¾à¤® à¤•à¤° à¤¦à¥‡, à¤²à¤¾à¤–à¥‹à¤‚ à¤°à¥à¤ªà¤¯à¥‡ à¤®à¤¿à¤²à¥‡à¤‚à¤—à¥‡à¥¤"

à¤°à¤¾à¤œà¥‚ à¤¶à¤• à¤•à¥€ à¤¨à¤¿à¤—à¤¾à¤¹ à¤¤à¥ˆ à¤¦à¥‡à¤–à¥à¤¯à¤¾à¥¤ "à¤•à¥Œà¤£ à¤¸à¤¾ à¤•à¤¾à¤® à¤¸à¥ˆ?"

à¤¶à¤‚à¤•à¤° à¤¬à¥‹à¤²à¥à¤¯à¤¾ - "à¤—à¤¾à¤® à¤•à¥‡ à¤œà¤¼à¤®à¥€à¤‚à¤¦à¤¾à¤° à¤•à¥‡ à¤˜à¤° à¤®à¥à¤¹ à¤à¤• à¤¬à¤¡à¤¼à¥€ à¤¤à¤¿à¤œà¥‹à¤°à¥€ à¤¸à¥ˆà¥¤ à¤‰à¤¸ à¤®à¥à¤¹ à¤•à¤°à¥‹à¤¡à¤¼à¥‹à¤‚ à¤•à¥‡ à¤œà¤¼à¥‡à¤µà¤° à¤°à¤¾à¤–à¥‡ à¤¸à¥ˆà¤‚à¥¤ à¤¬à¤¸ à¤µà¥‹ à¤¤à¤¿à¤œà¥‹à¤°à¥€ à¤–à¥‹à¤² à¤¦à¥‡à¥¤ à¤†à¤§à¤¾ à¤®à¤¾à¤² à¤¤à¥‡à¤°à¤¾, à¤†à¤§à¤¾ à¤®à¥à¤¯à¤¾à¤°à¤¾à¥¤"

à¤°à¤¾à¤œà¥‚ à¤¨à¥à¤¯à¥‚ à¤¸à¤‚à¤•à¥‹à¤š à¤¹à¥‹à¤¯à¤¾à¥¤ "à¤¨à¤¾à¤¹à¥€ à¤­à¤¾à¤ˆ, à¤šà¥‹à¤°à¥€-à¤¡à¤•à¥ˆà¤¤à¥€ à¤®à¥à¤¹ à¤®à¥à¤¯à¤¾à¤°à¤¾ à¤¹à¤¾à¤¥ à¤•à¥‹à¤¨à¥€à¥¤"

à¤ªà¤° à¤¶à¤‚à¤•à¤° à¤šà¤¾à¤²à¤¾à¤• à¤¸à¥ˆà¥¤ à¤¬à¥‹à¤²à¥à¤¯à¤¾ - "à¤¦à¥‡à¤– à¤°à¤¾à¤œà¥‚, à¤¤à¥‡à¤°à¥‡ à¤¬à¤¾à¤ª à¤¨à¥à¤¯à¥‚ à¤‡à¤²à¤¾à¤œ à¤šà¤¾à¤¹à¤¿à¤à¥¤ à¤¦à¥‹ à¤¦à¤¿à¤¨ à¤®à¥à¤¹ à¤‘à¤ªà¤°à¥‡à¤¶à¤¨ à¤¸à¥ˆà¥¤ à¤¦à¤¸ à¤²à¤¾à¤– à¤°à¥à¤ªà¤¯à¥‡ à¤²à¤¾à¤—à¥‡à¤‚à¤—à¥‡à¥¤ à¤¤à¥‡à¤°à¥‡ à¤•à¥‹à¤²à¥ˆ à¤•à¤¿à¤¤à¥à¤¤à¥‡ à¤¸à¥ˆà¤‚? à¤¦à¤¸ à¤¹à¤œà¤¼à¤¾à¤° à¤­à¥€ à¤¨à¤¾ à¤¹à¥‹à¤‚à¤—à¥‡à¥¤ à¤¸à¥‹à¤š à¤²à¥‡à¥¤"

à¤°à¤¾à¤œà¥‚ à¤•à¥‡ à¤¦à¤¿à¤®à¤¾à¤— à¤®à¥à¤¹ à¤¤à¥‚à¤«à¤¾à¤¨ à¤† à¤—à¤¯à¤¾à¥¤ à¤¬à¤¾à¤ª à¤•à¥€ à¤œà¤¾à¤¨ à¤¬à¤šà¤¾à¤£à¥€ à¤¸à¥ˆà¥¤ à¤ªà¤° à¤šà¥‹à¤°à¥€? à¤—à¤²à¤¤ à¤¬à¤¾à¤¤ à¤¸à¥ˆà¥¤

à¤°à¤¾à¤¤ à¤¨à¥à¤¯à¥‚ à¤°à¤¾à¤œà¥‚ à¤¸à¥‹ à¤¨à¤¾à¤¹à¥€ à¤ªà¤¾à¤¯à¤¾à¥¤ à¤¬à¤¾à¤ª à¤•à¥€ à¤¹à¤¾à¤²à¤¤ à¤¬à¤¿à¤—à¤¡à¤¼à¤¤à¥€ à¤œà¤¾ à¤°à¥€ à¤¸à¥ˆà¥¤ à¤®à¤¾à¤ à¤°à¥‹à¤µà¥ˆ à¤¸à¥ˆà¥¤ à¤¬à¤¹à¤¨ à¤šà¤¿à¤‚à¤¤à¤¾ à¤®à¥à¤¹ à¤¸à¥ˆà¥¤

à¤…à¤—à¤²à¥‡ à¤¦à¤¿à¤¨ à¤¸à¥à¤¬à¤¹, à¤°à¤¾à¤œà¥‚ à¤¨à¥à¤¯à¥‚ à¤«à¥ˆà¤¸à¤²à¤¾ à¤•à¤° à¤²à¤¿à¤¯à¤¾à¥¤ à¤¶à¤‚à¤•à¤° à¤¨à¥à¤¯à¥‚ à¤®à¤¿à¤²à¥à¤¯à¤¾à¥¤ "à¤ à¥€à¤• à¤¸à¥ˆ à¤­à¤¾à¤ˆ, à¤®à¥à¤¯à¥ˆ à¤•à¤°à¥‚à¤à¤—à¤¾à¥¤ à¤ªà¤° à¤à¤• à¤¶à¤°à¥à¤¤ à¤¸à¥ˆ - à¤•à¤¿à¤¸à¥‡ à¤¨à¥à¤¯à¥‚ à¤šà¥‹à¤Ÿ à¤¨à¤¾ à¤ªà¥‹à¤‚à¤¹à¤šà¤£à¥€ à¤šà¤¾à¤¹à¤¿à¤à¥¤ à¤¸à¤¿à¤°à¥à¤« à¤ªà¥ˆà¤¸à¥‡, à¤¹à¤¿à¤‚à¤¸à¤¾ à¤•à¥‹à¤¨à¥€à¥¤"

à¤¶à¤‚à¤•à¤° à¤®à¥à¤¸à¥à¤•à¥à¤°à¤¾à¤¯à¤¾à¥¤ "à¤¬à¤¿à¤²à¤•à¥à¤² à¤­à¤¾à¤ˆà¥¤ à¤¸à¤¿à¤°à¥à¤« à¤•à¤¾à¤® à¤¸à¤¾à¤«à¥¤"

à¤¯à¥‹à¤œà¤¨à¤¾ à¤¬à¤¨à¤¾à¤ˆ à¤—à¤ˆà¥¤ à¤¶à¤¨à¤¿à¤µà¤¾à¤° à¤•à¥€ à¤°à¤¾à¤¤à¥¤ à¤œà¤¼à¤®à¥€à¤‚à¤¦à¤¾à¤° à¤•à¤¾ à¤ªà¥‚à¤°à¤¾ à¤ªà¤°à¤¿à¤µà¤¾à¤° à¤¶à¤¾à¤¦à¥€ à¤®à¥à¤¹ à¤œà¤¾à¤µà¥‡à¤—à¤¾à¥¤ à¤˜à¤° à¤–à¤¾à¤²à¥€ à¤°à¤¹à¤µà¥‡à¤—à¤¾à¥¤ à¤¤à¤¿à¤œà¥‹à¤°à¥€ à¤°à¤¾à¤œà¥‚ à¤–à¥‹à¤²à¥‡à¤—à¤¾ - à¤‰à¤¸à¤¨à¥à¤¯à¥ˆ à¤µà¥‹ à¤•à¤¾à¤® à¤ªà¤¤à¥ˆ à¤¸à¥ˆà¥¤

à¤¶à¤¨à¤¿à¤µà¤¾à¤° à¤†à¤¯à¤¾à¥¤ à¤¶à¤¾à¤® à¤¹à¥‹à¤¤à¥€ à¤¹à¥€ à¤°à¤¾à¤œà¥‚ à¤•à¤¾ à¤¦à¤¿à¤² à¤œà¤¼à¥‹à¤°-à¤œà¤¼à¥‹à¤° à¤¤à¥ˆ à¤§à¤¡à¤¼à¤•à¤£ à¤²à¤¾à¤— à¤—à¤¯à¤¾à¥¤ à¤¶à¤‚à¤•à¤° à¤”à¤° à¤‰à¤¸à¤•à¥‡ à¤¦à¥‹ à¤¸à¤¾à¤¥à¥€ à¤¤à¥ˆà¤¯à¤¾à¤° à¤¸à¥ˆà¤‚à¥¤ à¤•à¤¾à¤²à¥‡ à¤•à¤ªà¤¡à¤¼à¥‡à¥¤ à¤®à¤¾à¤¸à¥à¤•à¥¤ à¤¸à¤¬ à¤•à¥à¤› à¤ªà¥à¤²à¤¾à¤¨ à¤®à¥à¤¤à¤¾à¤¬à¤¿à¤•à¥¤

à¤°à¤¾à¤¤ à¤•à¥‡ à¤¦à¤¸ à¤¬à¤œà¥‡à¥¤ à¤šà¤¾à¤°à¥‹à¤‚ à¤šà¥‹à¤° à¤œà¤¼à¤®à¥€à¤‚à¤¦à¤¾à¤° à¤•à¥‡ à¤˜à¤° à¤ªà¥‹à¤‚à¤¹à¤š à¤—à¤¯à¥‡à¥¤ à¤ªà¥€à¤›à¥‡ à¤•à¥€ à¤¦à¥€à¤µà¤¾à¤° à¤«à¤¾à¤‚à¤¦ à¤•à¥‡ à¤…à¤‚à¤¦à¤° à¤˜à¥à¤¸à¥‡à¥¤ à¤˜à¤° à¤…à¤‚à¤§à¥‡à¤°à¤¾ à¤¸à¥ˆà¥¤ à¤šà¥à¤ªà¥à¤ªà¥€ à¤¸à¥ˆà¥¤

à¤°à¤¾à¤œà¥‚ à¤•à¥‡ à¤¹à¤¾à¤¥ à¤•à¤¾à¤à¤ª à¤°à¥‡ à¤¸à¥ˆà¤‚à¥¤ à¤¤à¤¿à¤œà¥‹à¤°à¥€ à¤•à¥‡ à¤•à¥‹à¤²à¥ˆ à¤ªà¥‹à¤‚à¤¹à¤šà¥‡à¥¤ à¤¤à¤¾à¤²à¤¾ à¤¤à¥‹à¤¡à¤¼à¤£ à¤²à¤¾à¤— à¤—à¤¯à¤¾à¥¤ à¤¦à¤¸ à¤®à¤¿à¤¨à¤Ÿ à¤¬à¤¾à¤¦ - à¤•à¥à¤²à¤¿à¤•! à¤¤à¤¿à¤œà¥‹à¤°à¥€ à¤–à¥à¤² à¤—à¤ˆà¥¤

à¤…à¤‚à¤¦à¤° à¤¦à¥‡à¤–à¥à¤¯à¤¾ à¤¤à¥‹ à¤°à¤¾à¤œà¥‚ à¤•à¥€ à¤†à¤à¤–à¥‡à¤‚ à¤«à¤Ÿ à¤—à¤ˆà¤‚à¥¤ à¤¸à¥‹à¤¨à¥‡ à¤•à¥‡ à¤œà¤¼à¥‡à¤µà¤°à¥¤ à¤¹à¥€à¤°à¥‡à¥¤ à¤¨à¥‹à¤Ÿà¥‹à¤‚ à¤•à¥€ à¤—à¤¡à¥à¤¡à¤¿à¤¯à¤¾à¤à¥¤ à¤•à¤°à¥‹à¤¡à¤¼à¥‹à¤‚ à¤•à¤¾ à¤®à¤¾à¤²!

à¤¶à¤‚à¤•à¤° à¤”à¤° à¤¸à¤¾à¤¥à¥€ à¤®à¤¾à¤² à¤¥à¥ˆà¤²à¥‹à¤‚ à¤®à¥à¤¹ à¤­à¤°à¤£ à¤²à¤¾à¤— à¤—à¤¯à¥‡à¥¤ à¤°à¤¾à¤œà¥‚ à¤¹à¥ˆà¤°à¤¾à¤¨ à¤¸à¥ˆà¥¤ à¤‡à¤¤à¤¨à¤¾ à¤¸à¤¬ à¤¦à¥‡à¤–à¤•à¥ˆà¥¤

à¤¤à¤­à¥€ à¤…à¤šà¤¾à¤¨à¤• - à¤²à¤¾à¤‡à¤Ÿ à¤œà¤² à¤—à¤ˆ!

à¤œà¤¼à¤®à¥€à¤‚à¤¦à¤¾à¤° à¤•à¤¾ à¤¬à¥‡à¤Ÿà¤¾ à¤¸à¤¾à¤®à¤¨à¥‡ à¤–à¤¡à¤¼à¤¾ à¤¸à¥ˆà¥¤ à¤—à¤¨ à¤¹à¤¾à¤¥ à¤®à¥à¤¹à¥¤ "à¤¹à¤¾à¤¥ à¤Šà¤ªà¤° à¤•à¤°à¥‹ à¤¸à¤¬!"

à¤¶à¤‚à¤•à¤° à¤¨à¥à¤¯à¥‚ à¤—à¥‹à¤²à¥€ à¤šà¤²à¤¾ à¤¦à¥€! à¤§à¤¡à¤¼à¤¾à¤®! à¤œà¤¼à¤®à¥€à¤‚à¤¦à¤¾à¤° à¤•à¤¾ à¤¬à¥‡à¤Ÿà¤¾ à¤œà¤¼à¤–à¥à¤®à¥€ à¤¹à¥‹à¤•à¥‡ à¤—à¤¿à¤° à¤—à¤¯à¤¾!

à¤°à¤¾à¤œà¥‚ à¤šà¤¿à¤²à¥à¤²à¤¾à¤¯à¤¾ - "à¤¨à¤¾à¤¹à¥€ à¤­à¤¾à¤ˆ! à¤¹à¤®à¤¨à¥ˆ à¤¬à¥‹à¤²à¥à¤¯à¤¾ à¤¥à¤¾ à¤¹à¤¿à¤‚à¤¸à¤¾ à¤•à¥‹à¤¨à¥€!"

à¤¶à¤‚à¤•à¤° à¤¬à¥‹à¤²à¥à¤¯à¤¾ - "à¤­à¤¾à¤— à¤¯à¤¹à¤¾à¤ à¤¤à¥ˆ! à¤ªà¥à¤²à¤¿à¤¸ à¤†à¤£ à¤†à¤³à¥€ à¤¸à¥ˆ!"

à¤šà¤¾à¤°à¥‹à¤‚ à¤­à¤¾à¤—à¥‡à¥¤ à¤ªà¤° à¤°à¤¾à¤œà¥‚ à¤°à¥à¤• à¤—à¤¯à¤¾à¥¤ à¤œà¤¼à¤–à¥à¤®à¥€ à¤²à¤¡à¤¼à¤•à¥‡ à¤•à¥‡ à¤ªà¤¾à¤¸ à¤—à¤¯à¤¾à¥¤ "à¤°à¥à¤•à¥‹, à¤®à¥à¤¯à¥ˆ à¤à¤®à¥à¤¬à¥à¤²à¥‡à¤‚à¤¸ à¤¬à¥à¤²à¤¾à¤Šà¤ à¤¸à¥‚à¤‚à¥¤"

à¤¶à¤‚à¤•à¤° à¤—à¥à¤¸à¥à¤¸à¥‡ à¤®à¥à¤¹ à¤¬à¥‹à¤²à¥à¤¯à¤¾ - "à¤ªà¤¾à¤—à¤² à¤¹à¥‹à¤—à¥à¤¯à¤¾ à¤¸à¥ˆ à¤•à¥à¤¯à¤¾? à¤ªà¤•à¤¡à¤¼à¥‡ à¤œà¤¾à¤µà¥‡à¤—à¤¾!"

à¤ªà¤° à¤°à¤¾à¤œà¥‚ à¤¨à¥à¤¯à¥‚ à¤«à¥‹à¤¨ à¤¨à¤¿à¤•à¤¾à¤² à¤•à¥‡ 108 à¤¡à¤¾à¤¯à¤² à¤•à¤° à¤¦à¤¿à¤¯à¤¾à¥¤ "à¤à¤®à¥à¤¬à¥à¤²à¥‡à¤‚à¤¸ à¤­à¥‡à¤œà¥‹ à¤œà¤²à¥à¤¦à¥€à¥¤ à¤—à¥‹à¤²à¥€ à¤²à¤¾à¤— à¤°à¥€ à¤¸à¥ˆà¥¤"

à¤«à¤¿à¤° à¤ªà¥à¤²à¤¿à¤¸ à¤¨à¥à¤¯à¥‚ à¤«à¥‹à¤¨ à¤•à¤¿à¤¯à¤¾à¥¤ "à¤¸à¤¾à¤¹à¤¬, à¤§à¤¨à¥Œà¤°à¤¾ à¤—à¤¾à¤®, à¤œà¤¼à¤®à¥€à¤‚à¤¦à¤¾à¤° à¤•à¥‡ à¤˜à¤° à¤®à¥à¤¹ à¤¡à¤•à¥ˆà¤¤à¥€ à¤¹à¥‹à¤ˆ à¤¸à¥ˆà¥¤ à¤®à¥à¤¯à¥ˆ à¤–à¥à¤¦ à¤¡à¤•à¥ˆà¤¤ à¤¸à¥‚à¤‚à¥¤ à¤ªà¤° à¤à¤• à¤†à¤¦à¤®à¥€ à¤œà¤¼à¤–à¥à¤®à¥€ à¤¸à¥ˆà¥¤ à¤† à¤œà¤¾à¤“à¥¤"

à¤¶à¤‚à¤•à¤° à¤”à¤° à¤¬à¤¾à¤•à¥€ à¤¦à¥‹ à¤­à¤¾à¤— à¤—à¤¯à¥‡à¥¤ à¤°à¤¾à¤œà¥‚ à¤µà¤¹à¥€à¤‚ à¤°à¥à¤•à¥à¤¯à¤¾à¥¤ à¤²à¤¡à¤¼à¤•à¥‡ à¤¨à¥à¤¯à¥‚ à¤¸à¤¹à¤¾à¤°à¤¾ à¤¦à¥‡à¤¤à¤¾ à¤°à¥à¤¹à¤¾ à¤œà¤¬ à¤¤à¤• à¤à¤®à¥à¤¬à¥à¤²à¥‡à¤‚à¤¸ à¤¨à¤¾ à¤†à¤ˆà¥¤

à¤ªà¥à¤²à¤¿à¤¸ à¤†à¤ˆà¥¤ à¤°à¤¾à¤œà¥‚ à¤¨à¥à¤¯à¥‚ à¤—à¤¿à¤°à¤«à¥à¤¤à¤¾à¤° à¤•à¤° à¤²à¤¿à¤¯à¤¾à¥¤ à¤ªà¤° à¤‰à¤¸à¤¨à¥‡ à¤¸à¤¬ à¤¸à¤š à¤¬à¤¤à¤¾ à¤¦à¤¿à¤¯à¤¾à¥¤ à¤¶à¤‚à¤•à¤° à¤•à¤¾ à¤¨à¤¾à¤®, à¤ªà¤¤à¤¾, à¤¸à¤¬ à¤•à¥à¤›à¥¤

à¤…à¤—à¤²à¥‡ à¤¦à¤¿à¤¨ à¤¶à¤‚à¤•à¤° à¤”à¤° à¤¬à¤¾à¤•à¥€ à¤ªà¤•à¤¡à¤¼à¥‡ à¤—à¤¯à¥‡à¥¤ à¤ªà¥‚à¤°à¤¾ à¤®à¤¾à¤² à¤¬à¤°à¤¾à¤®à¤¦ à¤¹à¥‹à¤¯à¤¾à¥¤

à¤•à¥‹à¤°à¥à¤Ÿ à¤®à¥à¤¹ à¤¸à¥à¤¨à¤µà¤¾à¤ˆ à¤¹à¥‹à¤ˆà¥¤ à¤œà¤¼à¤®à¥€à¤‚à¤¦à¤¾à¤° à¤•à¤¾ à¤¬à¥‡à¤Ÿà¤¾ à¤¬à¤š à¤—à¤¯à¤¾à¥¤ à¤‰à¤¸à¤¨à¥à¤¯à¥‚ à¤•à¥‹à¤°à¥à¤Ÿ à¤®à¥à¤¹ à¤¬à¥‹à¤²à¥à¤¯à¤¾ - "à¤¸à¤¾à¤¹à¤¬, à¤°à¤¾à¤œà¥‚ à¤¨à¥à¤¯à¥ˆ à¤®à¥‡à¤°à¥€ à¤œà¤¾à¤¨ à¤¬à¤šà¤¾à¤ˆà¥¤ à¤µà¥‹ à¤­à¤Ÿà¤• à¤—à¤¯à¤¾ à¤¥à¤¾à¥¤ à¤ªà¤° à¤‡à¤‚à¤¸à¤¾à¤¨à¤¿à¤¯à¤¤ à¤¬à¤¾à¤•à¥€ à¤¥à¥€ à¤‰à¤¸à¤®à¥‡à¤‚à¥¤ à¤‰à¤¸à¤¨à¥à¤¯à¥ˆ à¤®à¤¾à¤«à¥€ à¤•à¥‡ à¤²à¤¾à¤¯à¤• à¤¸à¥ˆà¥¤"

à¤°à¤¾à¤œà¥‚ à¤•à¥‡ à¤¬à¤¾à¤ª à¤•à¤¾ à¤‡à¤²à¤¾à¤œ à¤œà¤¼à¤®à¥€à¤‚à¤¦à¤¾à¤° à¤¨à¥à¤¯à¥ˆ à¤–à¥à¤¦ à¤•à¤°à¤µà¤¾à¤¯à¤¾à¥¤ à¤•à¥‹à¤°à¥à¤Ÿ à¤¨à¥à¤¯à¥ˆ à¤°à¤¾à¤œà¥‚ à¤¨à¥à¤¯à¥‚ à¤®à¤¾à¤« à¤•à¤° à¤¦à¤¿à¤¯à¤¾ - à¤¸à¤®à¤¾à¤œ à¤¸à¥‡à¤µà¤¾ à¤•à¥€ à¤¸à¤œà¤¼à¤¾ à¤¦à¥€à¥¤

à¤°à¤¾à¤œà¥‚ à¤¨à¥à¤¯à¥ˆ à¤¸à¤¬à¤• à¤¸à¤¿à¤– à¤²à¤¿à¤¯à¤¾à¥¤ à¤šà¥‹à¤°à¥€ à¤•à¤¾ à¤°à¤¾à¤¸à¥à¤¤à¤¾ à¤—à¤²à¤¤ à¤¸à¥ˆà¥¤ à¤®à¥‡à¤¹à¤¨à¤¤ à¤•à¥€ à¤•à¤®à¤¾à¤ˆ à¤¹à¥€ à¤…à¤¸à¤²à¥€ à¤¸à¥ˆà¥¤

à¤”à¤° à¤¶à¤‚à¤•à¤°? à¤‰à¤¸à¤¨à¥à¤¯à¥ˆ à¤¦à¤¸ à¤¸à¤¾à¤² à¤•à¥€ à¤¸à¤œà¤¼à¤¾ à¤®à¤¿à¤²à¥€à¥¤

à¤¯à¥‡ à¤¸à¥ˆ "à¤•à¤¾à¤£à¥à¤¡ 2010" à¤•à¥€ à¤•à¤¹à¤¾à¤¨à¥€à¥¤ à¤¹à¤°à¤¿à¤¯à¤¾à¤£à¤¾ à¤•à¥‡ à¤§à¤¨à¥Œà¤°à¤¾ à¤—à¤¾à¤® à¤•à¥€à¥¤ à¤œà¥‹ à¤¸à¤¿à¤–à¤¾à¤µà¥ˆ à¤¸à¥ˆ - à¤—à¤²à¤¤ à¤°à¤¾à¤¸à¥à¤¤à¤¾ à¤•à¤¿à¤¤à¤¨à¤¾ à¤­à¥€ à¤›à¥‹à¤Ÿà¤¾ à¤²à¤¾à¤—à¥ˆ, à¤¸à¤¹à¥€ à¤°à¤¾à¤¸à¥à¤¤à¤¾ à¤¹à¥€ à¤…à¤¸à¤²à¥€ à¤¹à¥‹à¤µà¥ˆ à¤¸à¥ˆà¥¤

à¤¸à¤®à¤¾à¤ªà¥à¤¤à¥¤
`.trim();

console.log('â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—');
console.log('â•‘       ðŸŽ¬ HARYANVI STORY GENERATOR - KAAND 2010 STYLE             â•‘');
console.log('â•‘       Duration: 10-15 minutes | Language: Haryanvi                â•‘');
console.log('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
console.log('');

async function generateHaryanviStory() {
  try {
    console.log('ðŸ“ Step 1: Story Script Ready');
    console.log(`   Words: ~${HARYANVI_SCRIPT.split(' ').length}`);
    console.log(`   Characters: ${HARYANVI_SCRIPT.length}`);
    console.log('');

    // Generate audio with ElevenLabs (Haryanvi accent)
    console.log('ðŸŽ™ï¸  Step 2: Generating Haryanvi Narration...');
    console.log('   Using ElevenLabs with Indian voice...');

    const audioBuffer = await generateElevenLabsAudio(HARYANVI_SCRIPT);

    if (!audioBuffer) {
      throw new Error('Audio generation failed');
    }

    console.log('âœ… Narration generated successfully');
    console.log('');

    // Save temporary audio file
    const tempAudioPath = path.join(__dirname, '..', 'temp', 'haryanvi-narration.mp3');
    fs.mkdirSync(path.dirname(tempAudioPath), { recursive: true });
    fs.writeFileSync(tempAudioPath, audioBuffer);

    // Upload to S3
    console.log('â˜ï¸  Step 3: Uploading to S3...');
    const timestamp = Date.now();
    const s3Key = `audio/${timestamp}-haryanvi-kaand-2010.mp3`;

    const uploadParams = {
      Bucket: process.env.AWS_S3_BUCKET,
      Key: s3Key,
      Body: audioBuffer,
      ContentType: 'audio/mpeg'
    };

    await s3.upload(uploadParams).promise();
    const audioUrl = `https://${process.env.AWS_S3_BUCKET}.s3.${process.env.AWS_REGION}.amazonaws.com/${s3Key}`;

    console.log(`âœ… Uploaded: ${audioUrl}`);
    console.log('');

    // Calculate duration (approximate)
    const wordCount = HARYANVI_SCRIPT.split(' ').length;
    const estimatedDuration = Math.round((wordCount / 150) * 60); // 150 words per minute

    // Save to database
    console.log('ðŸ’¾ Step 4: Saving to database...');

    const dbPath = path.join(__dirname, '..', 'data', 'stories.json');
    const db = JSON.parse(fs.readFileSync(dbPath, 'utf8'));

    const newStory = {
      id: timestamp,
      title: "à¤•à¤¾à¤£à¥à¤¡ 2010 - à¤¹à¤°à¤¿à¤¯à¤¾à¤£à¤µà¥€ à¤•à¤¹à¤¾à¤¨à¥€",
      description: "à¤¹à¤°à¤¿à¤¯à¤¾à¤£à¤¾ à¤•à¥‡ à¤§à¤¨à¥Œà¤°à¤¾ à¤—à¤¾à¤® à¤•à¥€ à¤…à¤¸à¤²à¥€ à¤•à¤¹à¤¾à¤¨à¥€à¥¤ à¤šà¥‹à¤°à¥€, à¤¡à¤•à¥ˆà¤¤à¥€, à¤”à¤° à¤‡à¤‚à¤¸à¤¾à¤¨à¤¿à¤¯à¤¤ à¤•à¥€ à¤¦à¤¾à¤¸à¥à¤¤à¤¾à¤¨à¥¤",
      category: "Thriller",
      language: "Haryanvi",
      duration: estimatedDuration,
      audioPath: audioUrl,
      thumbnailUrl: "https://images.pexels.com/photos/1616403/pexels-photo-1616403.jpeg?w=400",
      createdAt: new Date().toISOString(),
      isHaryanvi: true,
      tags: ["haryanvi", "crime", "thriller", "kaand", "2010", "haryana"]
    };

    db.stories.unshift(newStory);
    fs.writeFileSync(dbPath, JSON.stringify(db, null, 2));

    console.log('âœ… Story saved to database');
    console.log('');

    console.log('â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—');
    console.log('â•‘                  ðŸŽ‰ STORY GENERATION COMPLETE!                     â•‘');
    console.log('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
    console.log('');
    console.log(`ðŸ“± Story Title: ${newStory.title}`);
    console.log(`â±ï¸  Duration: ~${estimatedDuration} seconds (${Math.round(estimatedDuration/60)} minutes)`);
    console.log(`ðŸŽ™ï¸  Language: Haryanvi`);
    console.log(`ðŸ“ Category: Thriller`);
    console.log(`ðŸ”— Audio URL: ${audioUrl}`);
    console.log('');
    console.log('ðŸŒ Access your story at: http://localhost:3005');
    console.log('   Story will appear at the TOP of the list!');
    console.log('');
    console.log('âœ… READY FOR TESTING!');

  } catch (error) {
    console.error('âŒ Error:', error.message);
    throw error;
  }
}

async function generateElevenLabsAudio(text) {
  return new Promise((resolve, reject) => {
    const apiKey = process.env.ELEVENLABS_API_KEY;

    // Using Indian male voice for Haryanvi narration
    const voiceId = 'pNInz6obpgDQGcFmaJgB'; // Adam - deep male voice

    const postData = JSON.stringify({
      text: text,
      model_id: 'eleven_multilingual_v2',
      voice_settings: {
        stability: 0.5,
        similarity_boost: 0.75,
        style: 0.8,
        use_speaker_boost: true
      }
    });

    const options = {
      hostname: 'api.elevenlabs.io',
      port: 443,
      path: `/v1/text-to-speech/${voiceId}`,
      method: 'POST',
      headers: {
        'Accept': 'audio/mpeg',
        'Content-Type': 'application/json',
        'xi-api-key': apiKey,
        'Content-Length': Buffer.byteLength(postData)
      }
    };

    const req = https.request(options, (res) => {
      const chunks = [];

      res.on('data', (chunk) => {
        chunks.push(chunk);
      });

      res.on('end', () => {
        if (res.statusCode === 200) {
          resolve(Buffer.concat(chunks));
        } else {
          reject(new Error(`ElevenLabs API returned ${res.statusCode}`));
        }
      });
    });

    req.on('error', (error) => {
      reject(error);
    });

    req.write(postData);
    req.end();
  });
}

// Run the generator
generateHaryanviStory().catch(console.error);
