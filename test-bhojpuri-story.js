// ğŸ¯ BHOJPURI STORY GENERATOR TEST
// Test script to generate one Bhojpuri story with audio

require('dotenv').config({ path: '.env.local' })
const fs = require('fs').promises

async function generateBhojpuriStory() {
  console.log('ğŸ¬ Starting Bhojpuri story generation...')

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // STEP 1: CREATE BHOJPURI STORY SCRIPT
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  const story = {
    title: "à¤¬à¤¾à¤¬à¥‚à¤œà¥€ à¤•à¥‡ à¤¸à¥€à¤–",
    category: "Motivation",
    script: `
à¤¨à¤®à¤¸à¥à¤•à¤¾à¤° à¤¸à¤¾à¤¥à¤¿à¤¯à¥‹! à¤†à¤œ à¤¹à¤® à¤¸à¥à¤¨à¤¾à¤µà¤¤ à¤¬à¤¾à¤¨à¥€ à¤à¤—à¥‹ à¤ªà¥à¤°à¥‡à¤°à¤• à¤•à¤¹à¤¾à¤¨à¥€ à¤¬à¤¾à¤¬à¥‚à¤œà¥€ à¤•à¥‡ à¤¸à¥€à¤– à¤•à¥‡ à¤¬à¤¾à¤°à¥‡ à¤®à¥‡à¤‚à¥¤

à¤—à¤¾à¤à¤µ à¤®à¥‡à¤‚ à¤à¤—à¥‹ à¤•à¤¿à¤¸à¤¾à¤¨ à¤°à¤¹à¤¤ à¤°à¤¹à¥‡, à¤°à¤¾à¤® à¤ªà¥à¤°à¤¸à¤¾à¤¦à¥¤ à¤‰à¤¨à¤•à¤° à¤¤à¥€à¤¨ à¤—à¥‹ à¤¬à¥‡à¤Ÿà¤¾ à¤°à¤¹à¥‡ - à¤®à¥‹à¤¹à¤¨, à¤¸à¥‹à¤¹à¤¨ à¤† à¤°à¥‹à¤¹à¤¨à¥¤ à¤¬à¤¾à¤¬à¥‚à¤œà¥€ à¤¦à¤¿à¤¨ à¤°à¤¾à¤¤ à¤®à¥‡à¤¹à¤¨à¤¤ à¤•à¤°à¤¤ à¤°à¤¹à¤²à¥‡, à¤–à¥‡à¤¤ à¤®à¥‡à¤‚ à¤•à¤¾à¤® à¤•à¤°à¤¤ à¤°à¤¹à¤²à¥‡à¥¤

à¤à¤• à¤¦à¤¿à¤¨ à¤¤à¥€à¤¨à¥‹ à¤­à¤¾à¤ˆ à¤†à¤ªà¤¸ à¤®à¥‡à¤‚ à¤à¤—à¤¡à¤¼à¤¾ à¤•à¤°à¥‡ à¤²à¤¾à¤—à¤²à¥¤ à¤®à¥‹à¤¹à¤¨ à¤•à¤¹à¥‡ - "à¤®à¥ˆà¤‚ à¤¸à¤¬à¤¸à¥‡ à¤¬à¤¡à¤¼à¤•à¤¾ à¤¹à¥‚à¤, à¤¸à¤¬à¤¸à¥‡ à¤œà¥à¤¯à¤¾à¤¦à¤¾ à¤¹à¤¿à¤¸à¥à¤¸à¤¾ à¤®à¥‹à¤•à¥‡ à¤®à¤¿à¤²à¥€à¥¤" à¤¸à¥‹à¤¹à¤¨ à¤¬à¥‹à¤²à¤² - "à¤¨à¤¾ à¤¨à¤¾, à¤®à¥ˆà¤‚ à¤¸à¤¬à¤¸à¥‡ à¤œà¥à¤¯à¤¾à¤¦à¤¾ à¤•à¤¾à¤® à¤•à¤°à¤¤ à¤¹à¥‚à¤, à¤®à¥‹à¤•à¥‡ à¤®à¤¿à¤²à¤² à¤šà¤¾à¤¹à¥€à¤‚à¥¤" à¤°à¥‹à¤¹à¤¨ à¤­à¥€ à¤…à¤ªà¤¨ à¤¦à¤¾à¤µà¤¾ à¤ à¥‹à¤•à¤¤ à¤°à¤¹à¥‡à¥¤

à¤¬à¤¾à¤¬à¥‚à¤œà¥€ à¤ˆ à¤¸à¤¬ à¤¦à¥‡à¤–à¤¤ à¤°à¤¹à¤²à¥‡à¥¤ à¤‰ à¤šà¥à¤ªà¤šà¤¾à¤ª à¤–à¥‡à¤¤ à¤¸à¥‡ à¤¤à¥€à¤¨ à¤—à¥‹ à¤²à¤•à¤¡à¤¼à¥€ à¤²à¥‡ à¤†à¤‡à¤²à¥¤ à¤à¤• à¤à¤• à¤²à¤•à¤¡à¤¼à¥€ à¤¤à¥€à¤¨à¥‹ à¤­à¤¾à¤ˆ à¤•à¥‡ à¤¦à¤¿à¤¹à¤²à¤¨ à¤† à¤¬à¥‹à¤²à¤² - "à¤¤à¥‹à¤¡à¤¼ à¤•à¥‡ à¤¦à¥‡à¤–à¤¾à¤µ à¤ˆ à¤²à¤•à¤¡à¤¼à¥€ à¤•à¥‡à¥¤"

à¤¤à¥€à¤¨à¥‹ à¤­à¤¾à¤ˆ à¤†à¤¸à¤¾à¤¨à¥€ à¤¸à¥‡ à¤²à¤•à¤¡à¤¼à¥€ à¤¤à¥‹à¤¡à¤¼ à¤¦à¤¿à¤¹à¤²à¥¤ à¤¤à¤¬ à¤¬à¤¾à¤¬à¥‚à¤œà¥€ à¤¤à¥€à¤¨ à¤—à¥‹ à¤²à¤•à¤¡à¤¼à¥€ à¤à¤• à¤¸à¤‚à¤— à¤¬à¤¾à¤‚à¤§ à¤¦à¤¿à¤¹à¤² à¤† à¤¬à¥‹à¤²à¤² - "à¤…à¤¬ à¤ˆ à¤¬à¤‚à¤¡à¤² à¤•à¥‡ à¤¤à¥‹à¤¡à¤¼ à¤•à¥‡ à¤¦à¥‡à¤–à¤¾à¤µà¥¤"

à¤¤à¥€à¤¨à¥‹ à¤­à¤¾à¤ˆ à¤ªà¥‚à¤°à¤¾ à¤œà¥‹à¤° à¤²à¤—à¤¾ à¤¦à¤¿à¤¹à¤², à¤ªà¤° à¤¬à¤‚à¤¡à¤² à¤¨à¤¾ à¤Ÿà¥‚à¤Ÿà¤²à¥¤ à¤ªà¤¸à¥€à¤¨à¤¾ à¤ªà¤¸à¥€à¤¨à¤¾ à¤¹à¥‹ à¤—à¤‡à¤², à¤ªà¤° à¤•à¤¾à¤®à¤¯à¤¾à¤¬ à¤¨à¤¾ à¤­à¤‡à¤²à¥¤

à¤¤à¤¬ à¤¬à¤¾à¤¬à¥‚à¤œà¥€ à¤®à¥à¤¸à¥à¤•à¥à¤°à¤¾ à¤•à¥‡ à¤¬à¥‹à¤²à¤² - "à¤¦à¥‡à¤–à¤²à¥‡à¤µ à¤¬à¥‡à¤Ÿà¤¾? à¤…à¤•à¥‡à¤²à¥‡ à¤¤à¥‚ à¤•à¤®à¤œà¥‹à¤° à¤¬à¤¾à¤¡à¤¼à¥‚, à¤œà¤‡à¤¸à¥‡ à¤•à¤¿ à¤à¤—à¥‹ à¤²à¤•à¤¡à¤¼à¥€à¥¤ à¤ªà¤° à¤œà¤¬ à¤¤à¥€à¤¨à¥‹ à¤­à¤¾à¤ˆ à¤¸à¤¾à¤¥ à¤°à¤¹à¤¬à¤¾, à¤¤à¤¬ à¤¤à¥‹à¤¹à¤¾à¤° à¤•à¥‹à¤ˆ à¤•à¥à¤› à¤¨à¤¾ à¤¬à¤¿à¤—à¤¾à¤¡à¤¼ à¤¸à¤•à¤¤à¥¤"

à¤¤à¥€à¤¨à¥‹ à¤­à¤¾à¤ˆ à¤¬à¤¾à¤¬à¥‚à¤œà¥€ à¤•à¥‡ à¤ªà¥ˆà¤° à¤›à¥‚ à¤•à¥‡ à¤®à¤¾à¤«à¥€ à¤®à¤¾à¤‚à¤—à¤²à¥¤ à¤“à¤¹ à¤¦à¤¿à¤¨ à¤¸à¥‡ à¤‰ à¤¸à¤¾à¤¥ à¤°à¤¹à¥‡ à¤²à¤¾à¤—à¤², à¤®à¤¿à¤² à¤•à¥‡ à¤•à¤¾à¤® à¤•à¤°à¥‡ à¤²à¤¾à¤—à¤²à¥¤

à¤¸à¤¾à¤² à¤­à¤° à¤®à¥‡à¤‚ à¤‰à¤¨à¤•à¤° à¤–à¥‡à¤¤ à¤•à¥‡ à¤‰à¤ªà¤œ à¤¦à¥à¤—à¥à¤¨à¤¾ à¤¹à¥‹ à¤—à¤‡à¤²à¥¤ à¤—à¤¾à¤à¤µ à¤®à¥‡à¤‚ à¤¸à¤¬à¤¸à¥‡ à¤–à¥à¤¶à¤¹à¤¾à¤² à¤ªà¤°à¤¿à¤µà¤¾à¤° à¤¬à¤¨ à¤—à¤‡à¤²à¥¤

à¤¬à¤¾à¤¬à¥‚à¤œà¥€ à¤•à¥‡ à¤ˆ à¤¸à¥€à¤– à¤¹à¤®à¥‡à¤¶à¤¾ à¤¯à¤¾à¤¦ à¤°à¤¾à¤–à¤² à¤šà¤¾à¤¹à¥€ - "à¤à¤•à¤¤à¤¾ à¤®à¥‡à¤‚ à¤¬à¤² à¤¬à¤¾à¥¤" à¤œà¤¬ à¤²à¥‹à¤— à¤®à¤¿à¤² à¤•à¥‡ à¤•à¤¾à¤® à¤•à¤°à¥‡à¤²à¤¾, à¤¤à¤¬ à¤•à¥‹à¤ˆ à¤­à¥€ à¤®à¥à¤¶à¥à¤•à¤¿à¤² à¤†à¤¸à¤¾à¤¨ à¤¹à¥‹ à¤œà¤¾à¤²à¤¾à¥¤

à¤¤à¥‹ à¤¸à¤¾à¤¥à¤¿à¤¯à¥‹, à¤†à¤œ à¤¸à¥‡ à¤†à¤ªà¤¨ à¤­à¤¾à¤ˆ à¤¬à¤¹à¤¨, à¤ªà¤°à¤¿à¤µà¤¾à¤°, à¤¦à¥‹à¤¸à¥à¤¤ à¤¸à¤¬à¤•à¥‡ à¤¸à¤¾à¤¥ à¤®à¤¿à¤² à¤•à¥‡ à¤°à¤¹à¤² à¤¸à¥€à¤–à¥€à¤‚à¥¤ à¤à¤—à¤¡à¤¼à¤¾ à¤›à¥‹à¤¡à¤¼à¥€à¤‚, à¤ªà¥à¤¯à¤¾à¤° à¤¬à¤¢à¤¼à¤¾à¤µà¥€à¤‚à¥¤

à¤¬à¤¾à¤¬à¥‚à¤œà¥€ à¤¹à¤®à¥‡à¤¶à¤¾ à¤•à¤¹à¤¤ à¤°à¤¹à¤²à¥‡ - "à¤…à¤•à¥‡à¤²à¤¾ à¤šà¤¨à¤¾ à¤­à¤¾à¤¡à¤¼ à¤¨à¤¾ à¤«à¥‹à¤¡à¤¼ à¤¸à¤•à¤¤, à¤ªà¤° à¤®à¥à¤Ÿà¥à¤ à¥€ à¤­à¤° à¤šà¤¨à¤¾ à¤¸à¥‡ à¤ªà¥‚à¤°à¤¾ à¤ªà¤°à¤¿à¤µà¤¾à¤° à¤•à¥‡ à¤ªà¥‡à¤Ÿ à¤­à¤° à¤œà¤¾à¤²à¤¾à¥¤"

à¤ˆ à¤°à¤¹à¥€ à¤¬à¤¾à¤¬à¥‚à¤œà¥€ à¤•à¥‡ à¤¸à¥€à¤–à¥¤ à¤†à¤¶à¤¾ à¤•à¤°à¤¤ à¤¬à¤¾à¤¨à¥€ à¤•à¤¿ à¤ˆ à¤•à¤¹à¤¾à¤¨à¥€ à¤†à¤ªà¤•à¥‡ à¤®à¤¨ à¤®à¥‡à¤‚ à¤¬à¤¸à¥€à¥¤

à¤§à¤¨à¥à¤¯à¤µà¤¾à¤¦! à¤œà¤¯ à¤¹à¤¿à¤¨à¥à¤¦! ğŸ™
    `.trim(),
    description: "à¤à¤—à¥‹ à¤ªà¥à¤°à¥‡à¤°à¤• à¤•à¤¹à¤¾à¤¨à¥€ à¤¬à¤¾à¤¬à¥‚à¤œà¥€ à¤•à¥‡ à¤¸à¥€à¤– à¤•à¥‡ à¤¬à¤¾à¤°à¥‡ à¤®à¥‡à¤‚, à¤œà¤µà¤¨ à¤¸à¤¿à¤–à¤¾à¤µà¥‡à¤²à¤¾ à¤•à¤¿ à¤à¤•à¤¤à¤¾ à¤®à¥‡à¤‚ à¤¬à¤² à¤¬à¤¾à¥¤",
    duration: "6 min",
    emoji: "ğŸ’ª"
  }

  console.log('âœ… Story script created:', story.title)
  console.log('ğŸ“ Category:', story.category)
  console.log('â±ï¸  Duration:', story.duration)
  console.log('\nğŸ“– Story preview:')
  console.log(story.script.substring(0, 200) + '...\n')

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // STEP 2: GENERATE AUDIO using ElevenLabs
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  console.log('ğŸ™ï¸  Generating audio with ElevenLabs...')

  try {
    // Use ElevenLabs with Hindi voice (supports Bhojpuri accent)
    const voiceId = 'pNInz6obpgDQGcFmaJgB' // We'll use multilingual voice

    const response = await fetch(`https://api.elevenlabs.io/v1/text-to-speech/${voiceId}`, {
      method: 'POST',
      headers: {
        'xi-api-key': process.env.ELEVENLABS_API_KEY,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        text: story.script,
        model_id: 'eleven_multilingual_v2',
        voice_settings: {
          stability: 0.6,
          similarity_boost: 0.8,
          style: 0.6,
          use_speaker_boost: true
        }
      })
    })

    if (!response.ok) {
      const errorText = await response.text()
      throw new Error(`ElevenLabs API error: ${response.status} - ${errorText}`)
    }

    // Save audio file locally for testing
    const audioBuffer = await response.arrayBuffer()
    const audioPath = './bhojpuri-test-story.mp3'
    await fs.writeFile(audioPath, Buffer.from(audioBuffer))

    console.log('âœ… Audio generated successfully!')
    console.log('ğŸ“ Saved to:', audioPath)
    console.log('ğŸ§ File size:', (audioBuffer.byteLength / 1024 / 1024).toFixed(2), 'MB')

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // STEP 3: SAVE STORY INFO
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    const storyInfo = {
      ...story,
      audioFile: audioPath,
      generatedAt: new Date().toISOString(),
      language: 'Bhojpuri',
      success: true
    }

    await fs.writeFile(
      './bhojpuri-story-info.json',
      JSON.stringify(storyInfo, null, 2)
    )

    console.log('âœ… Story info saved to: bhojpuri-story-info.json')
    console.log('\nğŸ‰ SUCCESS! Bhojpuri story generated completely!')
    console.log('\nğŸ§ Play the audio file: bhojpuri-test-story.mp3')

  } catch (error) {
    console.error('âŒ Error generating audio:', error.message)
    console.error('Full error:', error)
    process.exit(1)
  }
}

// Run the generator
generateBhojpuriStory().catch(error => {
  console.error('âŒ Fatal error:', error)
  process.exit(1)
})
